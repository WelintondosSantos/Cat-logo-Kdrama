<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard - K-Drama Cine</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <style>
        .admin-card {
            transition: transform 0.2s;
            cursor: pointer;
        }

        .admin-card:hover {
            transform: translateY(-5px);
            border-color: #0d6efd;
        }
    </style>
</head>

<body class="bg-light">

    <nav class="navbar navbar-dark bg-dark mb-4">
        <div class="container">
            <a class="navbar-brand" href="#">Admin Dashboard</a>
            <a href="../index.html" class="btn btn-outline-light btn-sm">Voltar ao Site</a>
        </div>
    </nav>

    <div class="container">
        <div class="row g-4">
            <!-- Manage Dramas (Start Here) -->
            <div class="col-md-4">
                <div class="card h-100 shadow-sm admin-card border-primary"
                    onclick="location.href='manage_dramas.html'">
                    <div class="card-body text-center">
                        <h1 class="text-primary mb-3"><i class="bi bi-pencil-square"></i></h1>
                        <h5 class="card-title fw-bold">Gerenciar Dramas</h5>
                        <p class="card-text text-muted">Adicionar, Editar e Excluir Dramas.</p>
                    </div>
                </div>
            </div>

            <!-- Manage Actors -->
            <div class="col-md-4">
                <div class="card h-100 shadow-sm admin-card border-success"
                    onclick="location.href='manage_actors.html'">
                    <div class="card-body text-center">
                        <h1 class="text-success mb-3"><i class="bi bi-person-video3"></i></h1>
                        <h5 class="card-title fw-bold">Gerenciar Atores</h5>
                        <p class="card-text text-muted">Adicionar, Editar e Excluir Atores.</p>
                    </div>
                </div>
            </div>

            <!-- Sync Tool -->
            <div class="col-md-4">
                <div class="card h-100 shadow-sm admin-card" onclick="location.href='sync_dramas.html'">
                    <div class="card-body text-center">
                        <h1 class="text-primary mb-3"><i class="bi bi-cloud-upload"></i></h1>
                        <h5 class="card-title">Sincronizar Dramas</h5>
                        <p class="card-text text-muted">Importar JSON para o Supabase.</p>
                    </div>
                </div>
            </div>

            <!-- Fix Duplicates -->
            <div class="col-md-4">
                <div class="card h-100 shadow-sm admin-card" onclick="location.href='fix_duplicates.html'">
                    <div class="card-body text-center">
                        <h1 class="text-warning mb-3"><i class="bi bi-eraser-fill"></i></h1>
                        <h5 class="card-title">Remover Duplicatas</h5>
                        <p class="card-text text-muted">Limpar registros duplicados.</p>
                    </div>
                </div>
            </div>

            <!-- Fix Paths -->
            <div class="col-md-4">
                <div class="card h-100 shadow-sm admin-card" onclick="location.href='fix_paths.html'">
                    <div class="card-body text-center">
                        <h1 class="text-info mb-3"><i class="bi bi-folder-symlink"></i></h1>
                        <h5 class="card-title">Corrigir Caminhos</h5>
                        <p class="card-text text-muted">Ajustar URLs de imagens.</p>
                    </div>
                </div>
            </div>

            <!-- Debug -->
            <div class="col-md-4">
                <div class="card h-100 shadow-sm admin-card" onclick="location.href='debug_dramas.html'">
                    <div class="card-body text-center">
                        <h1 class="text-secondary mb-3"><i class="bi bi-bug-fill"></i></h1>
                        <h5 class="card-title">Debug Rápido</h5>
                        <p class="card-text text-muted">Visualizar dados brutos.</p>
                    </div>
                </div>
            </div>

            <!-- Migrate Data (Legacy) -->
            <div class="col-md-4">
                <div class="card h-100 shadow-sm admin-card" onclick="location.href='migrate_data.html'">
                    <div class="card-body text-center">
                        <h1 class="text-secondary mb-3"><i class="bi bi-database-up"></i></h1>
                        <h5 class="card-title">Migrar LocalStorage</h5>
                        <p class="card-text text-muted">Ferramenta antiga de migração.</p>
                    </div>
                </div>
            </div>

            <!-- Convert Images -->
            <div class="col-md-4">
                <div class="card h-100 shadow-sm admin-card border-warning"
                    onclick="location.href='convert_images.html'">
                    <div class="card-body text-center">
                        <h1 class="text-warning mb-3"><i class="bi bi-images"></i></h1>
                        <h5 class="card-title fw-bold">Converter Imagens</h5>
                        <p class="card-text text-muted">Otimizar e converter para WebP.</p>
                    </div>
                </div>
            </div>

        </div>

        <!-- User Guide Section -->
        <div class="mt-5 pb-5">
            <hr class="mb-5">
            <h2 class="fw-bold mb-4"><i class="bi bi-info-circle-fill text-primary"></i> Guia de Uso das Ferramentas</h2>

            <div class="row g-4">
                <!-- Como Adicionar um Drama -->
                <div class="col-md-4">
                    <div class="card h-100 border-0 shadow-sm" style="border-radius: 15px;">
                        <div class="card-body">
                            <h5 class="card-title fw-bold text-primary mb-3">
                                <i class="bi bi-1-circle-fill"></i> Adicionar Drama
                            </h5>
                            <ol class="small text-muted ps-3">
                                <li class="mb-2">Acesse <strong>Gerenciar Dramas</strong> no painel acima.</li>
                                <li class="mb-2">Clique no botão azul <strong>+ Novo Drama</strong>.</li>
                                <li class="mb-2">Preencha as informações do drama (Título, Ano, Gêneros).</li>
                                <li class="mb-2">No campo <strong>Imagem</strong>, você pode colocar apenas o nome (ex: <code>18-Again</code>) que o sistema buscará na pasta de posters.</li>
                                <li class="mb-2">Clique em <strong>Salvar</strong>. O drama aparecerá instantaneamente no site.</li>
                            </ol>
                        </div>
                    </div>
                </div>

                <!-- Como Adicionar um Ator -->
                <div class="col-md-4">
                    <div class="card h-100 border-0 shadow-sm" style="border-radius: 15px;">
                        <div class="card-body">
                            <h5 class="card-title fw-bold text-success mb-3">
                                <i class="bi bi-2-circle-fill"></i> Adicionar Ator
                            </h5>
                            <ol class="small text-muted ps-3">
                                <li class="mb-2">Acesse <strong>Gerenciar Atores</strong>.</li>
                                <li class="mb-2">Digite o nome do ator e faça o upload da foto diretamente do seu computador.</li>
                                <li class="mb-2">A foto será enviada para o armazenamento seguro (Supabase Storage).</li>
                                <li class="mb-2">Clique em <strong>Adicionar Ator</strong> e ele aparecerá no carrossel de atores da página inicial.</li>
                            </ol>
                        </div>
                    </div>
                </div>

                <!-- Sincronização -->
                <div class="col-md-4">
                    <div class="card h-100 border-0 shadow-sm" style="border-radius: 15px;">
                        <div class="card-body">
                            <h5 class="card-title fw-bold text-info mb-3">
                                <i class="bi bi-3-circle-fill"></i> Sincronização (Massa)
                            </h5>
                            <p class="small text-muted">Use isto para atualizar centenas de dramas de uma vez usando o arquivo <code>dramas.json</code>:</p>
                            <ol class="small text-muted ps-3">
                                <li class="mb-2">Acesse <strong>Sincronizar Dramas</strong>.</li>
                                <li class="mb-2">A ferramenta lerá todos os dramas do arquivo local.</li>
                                <li class="mb-2">Clique em <strong>Iniciar Sincronização</strong>.</li>
                                <li class="mb-2">O sistema verificará duplicatas e atualizará/inserirá tudo no banco de dados automaticamente.</li>
                            </ol>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Auth Script Check (Simple) -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="../assets/js/config.js"></script>
    <script src="../assets/js/supa-client.js"></script>
    <script src="auth.js"></script>
    <script>
        // Very basic client-side protection
        // Ideally should check a role in DB
        async function checkAdmin() {
            const { data: { session } } = await window.supabaseClient.auth.getSession();
            if (!session) {
                alert("Acesso restrito. Faça login primeiro.");
                window.location.href = '../index.html';
                return;
            }
            // Add allowed emails here if needed for rudimentary security
            // const allowed = ['admin@example.com'];
            // if (!allowed.includes(session.user.email)) ...
        }
        checkAdmin();
    </script>
</body>

</html>