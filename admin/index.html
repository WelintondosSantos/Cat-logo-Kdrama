<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard - K-Drama Cine</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <style>
        .admin-card {
            transition: transform 0.2s;
            cursor: pointer;
        }

        .admin-card:hover {
            transform: translateY(-5px);
            border-color: #0d6efd;
        }
    </style>
</head>

<body class="bg-light">

    <nav class="navbar navbar-dark bg-dark mb-4">
        <div class="container">
            <a class="navbar-brand" href="#">Admin Dashboard</a>
            <a href="../index.html" class="btn btn-outline-light btn-sm">Voltar ao Site</a>
        </div>
    </nav>

    <div class="container">
        <div class="row g-4">
            <!-- Manage Dramas (Start Here) -->
            <div class="col-md-4">
                <div class="card h-100 shadow-sm admin-card border-primary"
                    onclick="location.href='manage_dramas.html'">
                    <div class="card-body text-center">
                        <h1 class="text-primary mb-3"><i class="bi bi-pencil-square"></i></h1>
                        <h5 class="card-title fw-bold">Gerenciar Dramas</h5>
                        <p class="card-text text-muted">Adicionar, Editar e Excluir Dramas.</p>
                    </div>
                </div>
            </div>

            <!-- Manage Actors -->
            <div class="col-md-4">
                <div class="card h-100 shadow-sm admin-card border-success"
                    onclick="location.href='manage_actors.html'">
                    <div class="card-body text-center">
                        <h1 class="text-success mb-3"><i class="bi bi-person-video3"></i></h1>
                        <h5 class="card-title fw-bold">Gerenciar Atores</h5>
                        <p class="card-text text-muted">Adicionar, Editar e Excluir Atores.</p>
                    </div>
                </div>
            </div>

            <!-- Sync Tool -->
            <div class="col-md-4">
                <div class="card h-100 shadow-sm admin-card" onclick="location.href='sync_dramas.html'">
                    <div class="card-body text-center">
                        <h1 class="text-primary mb-3"><i class="bi bi-cloud-upload"></i></h1>
                        <h5 class="card-title">Sincronizar Dramas</h5>
                        <p class="card-text text-muted">Importar JSON para o Supabase.</p>
                    </div>
                </div>
            </div>

            <!-- Fix Duplicates -->
            <div class="col-md-4">
                <div class="card h-100 shadow-sm admin-card" onclick="location.href='fix_duplicates.html'">
                    <div class="card-body text-center">
                        <h1 class="text-warning mb-3"><i class="bi bi-eraser-fill"></i></h1>
                        <h5 class="card-title">Remover Duplicatas</h5>
                        <p class="card-text text-muted">Limpar registros duplicados.</p>
                    </div>
                </div>
            </div>

            <!-- Fix Paths -->
            <div class="col-md-4">
                <div class="card h-100 shadow-sm admin-card" onclick="location.href='fix_paths.html'">
                    <div class="card-body text-center">
                        <h1 class="text-info mb-3"><i class="bi bi-folder-symlink"></i></h1>
                        <h5 class="card-title">Corrigir Caminhos</h5>
                        <p class="card-text text-muted">Ajustar URLs de imagens.</p>
                    </div>
                </div>
            </div>

            <!-- Debug -->
            <div class="col-md-4">
                <div class="card h-100 shadow-sm admin-card" onclick="location.href='debug_dramas.html'">
                    <div class="card-body text-center">
                        <h1 class="text-secondary mb-3"><i class="bi bi-bug-fill"></i></h1>
                        <h5 class="card-title">Debug Rápido</h5>
                        <p class="card-text text-muted">Visualizar dados brutos.</p>
                    </div>
                </div>
            </div>

            <!-- Migrate Data (Legacy) -->
            <div class="col-md-4">
                <div class="card h-100 shadow-sm admin-card" onclick="location.href='migrate_data.html'">
                    <div class="card-body text-center">
                        <h1 class="text-secondary mb-3"><i class="bi bi-database-up"></i></h1>
                        <h5 class="card-title">Migrar LocalStorage</h5>
                        <p class="card-text text-muted">Ferramenta antiga de migração.</p>
                    </div>
                </div>
            </div>

            <!-- Convert Images -->
            <div class="col-md-4">
                <div class="card h-100 shadow-sm admin-card border-warning"
                    onclick="location.href='convert_images.html'">
                    <div class="card-body text-center">
                        <h1 class="text-warning mb-3"><i class="bi bi-images"></i></h1>
                        <h5 class="card-title fw-bold">Converter Imagens</h5>
                        <p class="card-text text-muted">Otimizar e converter para WebP.</p>
                    </div>
                </div>
            </div>

            <!-- User Guide (New) -->
            <div class="col-md-4">
                <div class="card h-100 shadow-sm admin-card border-info" data-bs-toggle="modal"
                    data-bs-target="#guideModal">
                    <div class="card-body text-center">
                        <h1 class="text-info mb-3"><i class="bi bi-question-circle"></i></h1>
                        <h5 class="card-title fw-bold">Guia de Uso</h5>
                        <p class="card-text text-muted">Como usar as ferramentas.</p>
                    </div>
                </div>
            </div>

        </div>

        <!-- User Guide Modal -->
        <div class="modal fade text-dark" id="guideModal" tabindex="-1" aria-labelledby="guideModalLabel"
            aria-hidden="true">
            <div class="modal-dialog modal-lg">
                <div class="modal-content" style="border-radius: 20px;">
                    <div class="modal-header border-0 pb-0">
                        <h5 class="modal-title fw-bold fs-4" id="guideModalLabel">
                            <i class="bi bi-info-circle-fill text-primary"></i> Guia de Uso das Ferramentas
                        </h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body p-4">
                        <div class="row g-4">
                            <!-- Como Adicionar um Drama -->
                            <div class="col-md-12">
                                <h6 class="fw-bold text-primary mb-2"><i class="bi bi-1-circle-fill"></i> Adicionar
                                    Drama</h6>
                                <ul class="text-muted ps-3 small">
                                    <li class="mb-1">Clique em <strong>Gerenciar Dramas</strong> -> <strong>+ Novo
                                            Drama</strong>.</li>
                                    <li class="mb-1">Preencha o formulário. No campo <strong>Imagem</strong>, use apenas
                                        o nome (ex: <code>18-Again</code>).</li>
                                    <li class="mb-1">Clique em <strong>Salvar</strong> para publicar imediatamente.</li>
                                </ul>
                            </div>
                            <hr class="my-2">
                            <!-- Como Adicionar um Ator -->
                            <div class="col-md-12">
                                <h6 class="fw-bold text-success mb-2"><i class="bi bi-2-circle-fill"></i> Adicionar Ator
                                </h6>
                                <ul class="text-muted ps-3 small">
                                    <li class="mb-1">Clique em <strong>Gerenciar Atores</strong>.</li>
                                    <li class="mb-1">Digite o nome e faça o upload da foto.</li>
                                    <li class="mb-1">Ela será salva no Supabase Storage e aparecerá no carrossel.</li>
                                </ul>
                            </div>
                            <hr class="my-2">
                            <!-- Sincronização -->
                            <div class="col-md-12">
                                <h6 class="fw-bold text-info mb-2"><i class="bi bi-3-circle-fill"></i> Sincronização em
                                    Massa</h6>
                                <ul class="text-muted ps-3 small">
                                    <li class="mb-1">Use <strong>Sincronizar Dramas</strong> para ler o arquivo
                                        <code>dramas.json</code>.
                                    </li>
                                    <li class="mb-1">Isso atualiza centenas de registros de uma só vez no banco de
                                        dados.</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer border-0">
                        <button type="button" class="btn btn-primary px-4" data-bs-dismiss="modal"
                            style="border-radius: 10px;">Entendi</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Auth Script Check (Simple) -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="../assets/js/config.js"></script>
    <script src="../assets/js/supa-client.js"></script>
    <script src="auth.js"></script>
    <script>
        // Very basic client-side protection
        // Ideally should check a role in DB
        async function checkAdmin() {
            const { data: { session } } = await window.supabaseClient.auth.getSession();
            if (!session) {
                alert("Acesso restrito. Faça login primeiro.");
                window.location.href = '../index.html';
                return;
            }
            // Add allowed emails here if needed for rudimentary security
            // const allowed = ['admin@example.com'];
            // if (!allowed.includes(session.user.email)) ...
        }
        checkAdmin();
    </script>
</body>

</html>